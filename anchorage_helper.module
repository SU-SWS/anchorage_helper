<?php
/**
* @file
* Code for the Anchorage Helper module.
*/

/**
 * Implements hook_mail_alter().
 */
function anchorage_helper_mail_alter(&$message) {
  $debug = \Drupal::config('anchorage_helper.settings')->get('anchorage_helper_debug');
  if ($debug) {
    \Drupal::configFactory()->getEditable('anchorage_helper.settings')->set('anchorage_helper_pre', $message)->save();
  }
  $message['headers']['Reply-To'] = $message['from'];
  $from = \Drupal::config('anchorage_helper.settings')->get('anchorage_helper_ses_from');
  $message['from'] = $from;
  $message['headers']['From'] = $from;
  $message['headers']['Sender'] = $from;
  $message['headers']['Return-Path'] = $from;
  if ($debug) {
    \Drupal::configFactory()->getEditable('anchorage_helper.settings')->set('anchorage_helper_post', $message)->save();
  }
}